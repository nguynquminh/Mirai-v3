module.exports.config = {
	name: "help",
	version: "1.2.0",
	hasPermssion: 0,
	credits: "Mirai Team & Dollie",
	description: "Bảng trợ giúp đáng yêu chứ? chứ?",
	commandCategory: "system",
	usages: "[tên lệnh]",
	cooldowns: 5,
	envConfig: {
		useCuteEmoji: true
	}
};

module.exports.languages = {
	"vi": {
		"moduleInfo": "🌸 𝗧𝗘̂𝗡 𝗟𝗘̣𝗡𝗛: %1\n🍄 𝗠𝗼̂ 𝗧𝗔̉: %2\n\n🐰 𝗖𝗔́𝗖𝗛 𝗗𝘂̀𝗻𝗴: %3\n🎀 𝗗𝗮𝗻𝗵 𝗺𝘂̣𝗰: %4\n⏱ 𝗧𝗵𝗼̛̀𝗶 𝗴𝗶𝗮𝗻 𝗰𝗵𝗼̛̀: %5 𝗴𝗶𝗮̂𝘆\n🔐 𝗤𝘂𝘆𝗲̂̀𝗻 𝗵𝗮̣𝗻: %6\n\n🧸 𝗧𝗮́𝗰 𝗴𝗶𝗮̉: %7",
		"helpHeader": "🎀 𝗗𝗔𝗡𝗛 𝗦𝗔́𝗖𝗛 𝗟𝗘̣̂𝗡𝗛 𝗖𝗨̉𝗔 𝗕𝗢𝗧 🎀\n━━━━━━━━━━━━━━\n",
		"categoryTitle": "\n🍒 𝗠𝗨̣𝗖 𝗟𝗘̣̂𝗡𝗵 » %1\n",
		"commandItem": "✨ 𝗟𝗘̣̂𝗡𝗛: %1 » 𝗚𝗵𝗶 𝗰𝗵𝘂́: %2\n",
		"helpFooter": "\n━━━━━━━━━━━━━━\n🌸 𝗚𝗵𝗶 \"%1help + 𝘁𝗲̂𝗻 𝗹𝗲̣̂𝗻𝗵\" 𝗱𝗲̂̉ 𝘅𝗲𝗺 𝗰𝗵𝗶 𝘁𝗶𝗲̂́𝘁 𝗻𝗵𝗮𝗮𝗮~",
		"user": "𝗧𝗵𝗮̀𝗻𝗵 𝘃𝗶𝗲̂𝗻 𝗯𝗶̀𝗻𝗵 𝘁𝗵𝘂̛𝗼̛̀𝗻𝗴",
		"adminGroup": "𝗤𝘂𝗮̉𝗻 𝘁𝗿𝗶̣ 𝘃𝗵𝗼́𝗺",
		"adminBot": "𝗤𝘂𝗮̉𝗻 𝘁𝗿𝗶̣ 𝗩𝗶𝗲̂𝗻 𝗕𝗼𝘁",
		"totalCommands": "𝗛𝗶𝗲̣̂𝗻 𝗰𝗼́ tổng cộng %1 𝗹𝗲̣̂𝗻𝗵 𝗻𝗵𝗮 💖"
	},
	"en": {
		"moduleInfo": "🌸 𝗖𝗢𝗠𝗠𝗔𝗡𝗗: %1\n🍄 𝗗𝗘𝗦𝗖𝗥𝗜𝗣𝗧𝗜𝗢𝗡: %2\n\n🐰 𝗨𝗦𝗔𝗚𝗘: %3\n🎀 𝗖𝗔𝗧𝗘𝗚𝗢𝗥𝗬: %4\n⏱ 𝗖𝗢𝗢𝗟𝗗𝗢𝗪𝗡: %5 𝗦𝗘𝗖𝗢𝗡𝗗𝗦\n🔐 𝗣𝗘𝗥𝗠𝗜𝗦𝗦𝗜𝗢𝗡: %6\n\n🧸 𝗔𝗨𝗧𝗛𝗢𝗥: %7",
		"helpHeader": "🎀 𝗕𝗢𝗧 𝗖𝗢𝗠𝗠𝗔𝗡𝗗 𝗟𝗜𝗦𝗧 🎀\n━━━━━━━━━━━━━━\n",
		"categoryTitle": "\n🍒 𝗖𝗔𝗧𝗘𝗚𝗢𝗥𝗬 » %1\n",
		"commandItem": "✨ 𝗖𝗢𝗠𝗠𝗔𝗡𝗗: %1 » 𝗗𝗘𝗦𝗖: %2\n",
		"helpFooter": "\n━━━━━━━━━━━━━━\n🌸 𝗧𝘆𝗽𝗲 \"%1help + 𝗰𝗼𝗺𝗺𝗮𝗻𝗱 𝗻𝗮𝗺𝗲\" 𝗳𝗼𝗿 𝗱𝗲𝘁𝗮𝗶𝗹𝘀~",
		"user": "𝗡𝗼𝗿𝗺𝗮𝗹 𝗨𝘀𝗲𝗿",
		"adminGroup": "𝗚𝗿𝗼𝘂𝗽 𝗔𝗱𝗺𝗶𝗻",
		"adminBot": "𝗕𝗼𝘁 𝗔𝗱𝗺𝗶𝗻",
		"totalCommands": "𝗡𝗼𝘄 𝗵𝗮𝘃𝗲 %1 𝗰𝘂𝘁𝗲 𝗰𝗼𝗺𝗺𝗮𝗻𝗱𝘀 𝘂𝘀𝗮𝗯𝗹𝗲 💖"
	}
};

module.exports.run = function({ api, event, args, getText }) {
	const { commands } = global.client;
	const { threadID, messageID } = event;
	const threadSetting = global.data.threadData.get(parseInt(threadID)) || {};
	const prefix = threadSetting.PREFIX || global.config.PREFIX;
	
	// Xem chi tiết lệnh
	if (args[0]) {
		const command = commands.get(args[0].toLowerCase());
		if (!command) {
			return api.sendMessage(`🌸 𝗞𝗵𝗼̂𝗻𝗴 𝘁𝗶̀𝗺 𝘁𝗵𝗮̂́𝘆 𝗹𝗲̣̂𝗻𝗵 "${args[0]}" 𝗻𝗵𝗮 𝗯𝗲́ 𝗼̛𝗶~`, threadID, messageID);
		}
		
		const infoMessage = getText(
			"moduleInfo",
			command.config.name,
			command.config.description,
			`${prefix}${command.config.name} ${command.config.usages || ""}`.trim(),
			command.config.commandCategory,
			command.config.cooldowns,
			command.config.hasPermssion == 0 ? getText("user") : 
			command.config.hasPermssion == 1 ? getText("adminGroup") : getText("adminBot"),
			command.config.credits
		);
		
		return api.sendMessage(infoMessage, threadID, messageID);
	}

	// Hiển thị toàn bộ danh sách
	let helpMessage = getText("helpHeader");
	const categories = {};
	
	// Nhóm lệnh theo category
	commands.forEach(cmd => {
		const category = cmd.config.commandCategory;
		if (!categories[category]) {
			categories[category] = [];
		}
		categories[category].push(cmd);
	});

	// Xây dựng message
	Object.entries(categories).forEach(([category, cmds]) => {
		helpMessage += getText("categoryTitle", category);
		cmds.forEach(cmd => {
			helpMessage += getText("commandItem", 
				cmd.config.name, 
				cmd.config.description
			);
		});
	});

	helpMessage += getText("helpFooter", prefix);
	helpMessage += "\n" + getText("totalCommands", commands.size);
	
	// Gửi tin nhắn
	return api.sendMessage(helpMessage, threadID, (err, info) => {
		if (this.config.envConfig.autoUnsend) {
			setTimeout(() => api.unsendMessage(info.messageID), this.config.envConfig.delayUnsend * 1000);
		}
	});
};